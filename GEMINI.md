데스티니 모작 언리얼 프로젝트 설계 문서

1\. 개요

본 문서는 데스티니 가디언즈를 모작하는 언리얼 엔진 기반 프로젝트에서 핵심 시스템 및 콘텐츠에 대한 설계를 기술한다. 구체적으로 게임 내 전설 임무인 개시 시간을 모작하는 것이 목표다. 1인칭 플레이어의 액션, 적 AI와 행동, 레벨 디자인, 맵 구성, UI 구성, 핵심 클래스 정의 등 주요 구현 목표를 상세히 다룬다.

2\. 핵심 시스템

본 프로젝트는 다음 핵심 시스템으로 구성된다.

플레이어의 캐릭터와 적 캐릭터는 복수의 충돌체 컴포넌트를 가지고 있다. 발사체는 헤드, 바디를 구분한다. 발사체가 아닌 스킬 또한 구분할 수 있도록 충돌체를 따로 둘 것이다.

총은 핸드캐논, 정찰소총, 로켓발사기로 일반적인 총의 역할은 물론 특수한 효과를 가지고 있다. 탄창 및 잔탄 시스템을 가지고 있고 총알은 적을 처치하면 랜덤 확률로 드랍한다.

적들은 캐릭터를 향해 사격할 뿐만 아니라 플레이어가 사격하거나 조준을 하면 이를 인지하고 일정 확률로 엄폐하는 시스템을 가지고 실제 전투의 느낌을 최대한 살린다.

데미지 스킨은 이전 프로젝트에서 사용했던 걸 재활용한다. 폰트만 바꾸면 데스티니 가디언즈 스타일로 쉽게 변환할 수 있다. 다만 일반-치명타를 구분하기 위해서 데이터 클래스가 필요하지 않을까 싶다.

고스트는 플레이어의 진행을 돕는 파트너로 대사를 통해 힌트를 주고 맵 마커를 찍어주면서 길 안내를 한다. 맵이 넓고 기믹이 있는 만큼 플레이어가 헤메지 않도록 도와주는 중요한 역할을 맡는다.

UI는 캐릭터의 체력, 적의 체력, 탄창과 잔탄, 스킬 쿨타임, 맵 마커, 현재 목표, 공격한 적의 방향, 제한 시간, 상호작용 가능성 등의 중요한 정보를 표시해줘야 한다.

2.1. 플레이어 시스템

플레이어는 다양한 무기 및 스킬을 사용하여 전투를 진행한다. 점프맵의 낙사 구간을 도움닫기와 2단 점프를 적절하게 활용해 뛰어넘어 다음 목표 지점으로 이동할 것이다. 퍼즐맵에 깔려있는 즉사 오브젝트와 술래잡기를 하면서 스위치를 조작해 탈출구를 개방할 것이다.



언리얼에서 제공하는 캐릭터 무브먼트 컴포넌트를 최대한 활용.

정조준 시스템은 어쩌고저쩌고

HP - 총마다 공격력 - 데이터에셋 - UI 델리게이트로 받을 수 있게

2.1.1. 무기

핸드캐논 (스페이드 에이스): 8발 탄창을 가진 근중거리 고화력 리볼버. 치명타로 처치하면 적이 폭발하며 주변에 있는 적에게 연쇄적인 데미지를 준다.

&nbsp;	

정찰소총 (변신) : 15발 탄창을 가진 장거리 고화력 정찰소총. 치명타 피해가 2배로 들어가고 처치하면 탄환을 1발 반환하여 장거리 저격전에 유리하다.

&nbsp;

로켓 발사기 (위드클리프 코일): 작은 미사일을 난사하는 특대화력 로켓발사기. 넓은 범위에 산재한 복수의 적을 쓸어버리거나, 보스 하나에게 전부 쏟아부어 막대한 데미지를 줄 수 있음.

2.1.2. 스킬

근접 스킬: 근거리 공격 (화염 주먹, 단검 투척, 마법 파동 등)

특수 스킬: 원거리 투척 공격 (수류탄, 회복 지대, 실드 설치 등)

궁극기: 에너지가 전부 차면 사용할 수 있는 강력한 특수 능력 (칼날폭풍, 천둥충돌 등)

2.1.3. 구현할 수 있는 액션

액션

입력

달리기

SHIFT 토글

웅크리기

CTRL 토글

슬라이드

달리는 중 CTRL

2단 점프

SPACE (두 번 누름)

스위치 상호작용

E (꾹 누름)

사격

좌클릭

정조준

우클릭

근접 스킬, 공격

C

투척 스킬

Q

특수 스킬

Z

궁극기

F



2.2. AI 에너미 시스템

AI 에너미는 세 가지 종류로 구성되며, 각기 다른 전투 방식을 가진다.

2.2.1. 드론형 적

정찰 드론 : 공중에서 엄폐물의 제한없이 플레이어를 사격하면서 짜증나게 만드는 역할. 데미지는 약하지만 플레이어의 시선을 분산시켜서 가만히 있지 못하게 만든다. 처음 등장하면 플레이어와 거리가 머니까 대략 15m 정도의 거리까지 접근, 호버링, 선회한다. 플레이어가 다가온다고 도망치지는 않는다.



자폭 드론 : 시끄러운 경고음을 울리며 플레이어에게 접근해 자폭, 치명적인 데미지를 입히는 역할. 폭발물을 둘러싸고 있기 때문에 체력은 가장 적은 편이다. 플레이어는 자연스럽게 자폭드론을 우선순위에 두게 된다. 처음 등장하면 특별한 로직 없이 일직선으로 달려오게 만든다.



2.2.2. 노말 몹

방랑자 : 플레이어의 시선을 감지하여 근처의 엄폐물로 숨거나 회피 기동을 수행한다. 계속하면 너무 짜증나니까 한 번 숨고나서는 더 이상 엄폐나 회피를 하지않도록 제한한다. 일반병을 처치하기 위해서 플레이어는 자연스럽게 사격이 가능한 위치로 움직이게 된다. 적당히 아픈 데미지를 입힌다.



2.2.2. 엘리트 몹

서비터 : 일정한 위치에 서서 플레이어를 향해 포격을 수행한다. 착탄하면 폭발하면서 주변에 꽤나 아픈 데미지를 입힌다. 포구는 약점이기도 해서 치명타를 이용해 빠르게 처치하게 된다. 처치하면 폭발을 일으키면서 주변에 큰 데미지를 입힌다.



2.2.3. 보스 몹

구원의 가문 시릭스 : 보스는 높은 체력을 가지며, 플랫폼을 점프하며 이동함으로써 플레이어의 위치를 강제하여 전략적인 움직임을 유도한다. 로켓발사기로 집요하게 포격하는데 체력은 무식하게 크기 때문에 계속해서 움직이면서 싸워야 한다. 2분 정도의 분량 예상.



2.3. 맵 시스템

맵은 던전 형식으로 구성되며, 다양한 기믹과 분위기 연출을 통해 플레이어 경험을 향상시킨다.

2.3.1. 맵 구성

던전 형식 : 선형적 던전 구조

점프 맵 : 레벨 디자인을 활용한 점프 구간

퍼즐 기믹 : 플레이어가 해결해야 하는 퍼즐 요소

2.3.2. 레벨 디자인

던전은 점프 맵 -> 엘리베이터 -> 플랫폼 -> 퍼즐 -> 보스룸으로 이루어져 있다.	

2.3.3. 각 레벨의 특징

점프 맵 : 가까스로 닿을만한 거리에 난간이 설치되어 있다. 다음 난간까지는 거리가 많이 멀어서 중간에 왔다리갔다리하는 플랫폼을 타고 거리를 좁혀야 한다. 타이밍을 잘 맞춰서 뛰지 않으면 닿지 않을 수도 있다. 플레이어의 시선 사각에서 저격수가 대기 하고 있다가 저격 범위 내에 들어오면 사격. 플레이어는 깜짝 놀라서 뒤를 돌아보게 된다.



엘리베이터 : 거대한 공동에 입장하면 하늘에서 빛이 들어와 지름이 20m 정도 엘리베이터를 비추고 있다. 엘리베이터 위에 올라서면 자동으로 상승하기 시작한다. 50m를 상승하는 동안 사방에서 드론형 적이 출현. 저격수까지 등장에서 플레이어를 집요하게 노린다. 엘리베이터에 접근하기 전에 열심히 사격해서 격추해야 한다. 특정 고도까지 올라가면 더 이상 쫓아오지 않는다.



플랫폼 전투 : 엘리베이터를 벗어나면 광활한 공간에 떠 있는 플랫폼이 눈에 들어온다. 플레이어는 플랫폼을 넘나들면서 적들을 처치한다. 플레이어가 조준하면 적들은 엄폐물로 숨어버리기 때문에 공격하기가 곤란하다. 플레이어는 중간중간에 설치된 폭탄을 저격해 터트리거나 사격이 가능한 포지션으로 이동하면서 적을 효율적으로 처치해나간다. 



술래잡기 퍼즐 : 어둡고 붉은색에 좁고 답답한 느낌이 물씬 나는 공간에 들어선다. 작은 컨트롤 룸에는 탈출구를 열기 위한 스위치의 위치가 표시되어 있다. 좁은 환풍구로 떨어져 통로에 입장하면 인간도 갈아버리는 무시무시한 청소기가 가동되어 쫓아온다. 청소기를 잘 피해서 스위치를 내리면 탈출구가 열리고 청소기가 쫓아오기 전에 빠져나간다.

보스 전투 : 저 멀리 광활한 대지, 도시, 구름으로 둘러싸인 시원한 공간에서 보스와 결전을 벌인다. 보스는 하늘에 떠 있는 플랫폼 이곳저곳을 주기적으로 뛰어다니기 때문에 플레이어는 계속 쫓아다니고, 잡몹들이 길을 가로막기 때문에 불편함을 느낀다. 마침내 보스를 처치하면 보물상자가 나오고 그걸 열면 보상을 받으면서 던전을 클리어하게 된다.





2.3.4 맵 최적화 구문



level 전환 방식 -> move to level 

단순 레벨 이동 방식  맵에 일정 구간에서 플레이어 이동을 제한한 후 그 사이에 레벨을 전환하는데, 똑같은 공간을 보여주며 플레이어에게 이질감을 못느끼게 하는 방법.

레벨 스트리밍 -> volume 을 이용하는 방식

volume 을 이용하여 일정 공간에 들어갈때 volume 안에 해당되어있는 디자인을 이벤트로 온 오프 처리 하는 방식.

월드 파티션 -> 여러 방식으로 해결할수있음

그리드 기반 렌더링, 셀을 지정해서 플레이어가 일정 범위안에 들어갈 때 렌더링한다. 런타임 그리드로 온-오프 하는 방식.

data layer로 셀을 묶어서 지정도 가능 -> hold 를 이러한 방식으로 묶어서

사용할수 있다.

hold 일정 거리 이상일때 품질의 강도를 낮춰서 최적화 하는 방식중 하나

lod 로 조절하는 방식도 있는데 이건 마야 켜야함

3\. 핵심 클래스

캐릭터 : 

체력 관련 : 프로퍼티 + 델리게이트로 UI 지원.

IDamagable 인터페이스 구현 : 발사체 및 공격 상호작용.

IInteractable 인터페이스 구현 : 맵 오브젝트와 상호작용.

걷기 속도 관련 : 

달리기 속도 관련 : 

점프 높이 관련 : 

중력 관련 : 

무기 전환 : 

무기 정보 : 

에너미 : 

스테이트 머신 기반 : 사격, 회피, 엄폐, 진격, 근접의 4가지 상태를 전환.

조준 경고 : 플레이어의 시선에서 뻗어나온 라인트레이스에 의해 메서드 호출.

엄폐 포인트 검색 : 맵에 미리 배치되어 있는 회피 포인트 검색 및 이동.

인간형 몹 경로 탐색 : 목표 위치까지 걸어서 이동할 것인가 한 번에 점프할 것인가?

공중형 몹 경로 탐색 : 목표 위치까지 도달할 수 있는 비행 경로 획득.

오브젝트 풀링 : 

오브젝트 풀링의 필요성 : 데스티니 가디언즈의 특성 상 발사체, 적 등이 굉장히 빈번하게 등장하기 때문에 풀링을 하지 않으면 성능 문제 발발.

제네릭 오브젝트 풀링 컨테이너 : 제네릭 프로그래밍을 활용하여 총알1, 총알2를 위한 복수의 오브젝트 풀링 컨테이너를 만들어서 사용한다.

Object Pooling Manager : 오브젝트 풀링 컨테이너를 통제하는 매니저로, 매니저를 통해서 원하는 오브젝트를 Pop과 Push로 획득 반환하도록 만든다. 

IObjectPoolable : 오브젝트 풀링이 가능한 오브젝트로 삭제 요청을 하는 대신 Pop과 Push를 통해서 반환하도록 한다.

발사체 : 

베이스 : Projectile 컴포넌트를 달아 비행하며 여러 파생 클래스로 분화될 수 있도록 한다.

에너미 불릿 : 방랑자 일반병들은 약한 추적 기능이 달려있는 총탄을 발사해 회피를 강요한다.

발사체 데이터 구조체 : 

Gun Type : 발사체가 어디서 왔는지 구분.

Projectile Damage : 피격 대상에게 적용할 데미지 양.

Projectile From : Ally 혹은 Enemy로 팀 구분용. 피격 처리 시 Ally는 Ally의 총알을 무시하도록 해야 한다. Enemy는 Enemy의 발사체를 무시하도록 해야 한다.

Gun Reference : 데미지 처리 후 특수 효과 호출용.

Gun Effect Delegate : 데미지 처리 후 특수 효과 호출용.

콜리전 프리셋 : 

Head : 발사체의 헤드 명중 인식용.

Body : 발사체의 바디 명중 인식용.

Projectile : 헤드 및 바디와 충돌 인식용.

Interact : 정면 범위에 상호작용 오브젝트 인식용. 플레이어 정면에 달린 인터렉트박스와 인터렉트오브젝트만 서로를 오버랩할 수 있도록 한다.

인터페이스 : 

IDamagable : 총알을 맞아서 상호작용하는 액터가 상속받는 인터페이스. 적과 플레이어가 서로 데미지를 주는 상황은 물론, 총알로 맵의 특수 기믹 오브젝트와도 상호작용할 수 있도록 한다.

IInteractable : 상호작용 가능한 액터가 상속받는 인터페이스. UI가 뜨면서 E키를 누르면 상호작용 메서드를 호출하도록 한다.

3\. 프로토타입 구현 목표

게임의 전체적인 분위기 및 핵심 메커니즘 시연용 맵 샘플 제작: 단순한 맵을 넘어, 데스티니 가디언즈의 특징적인 비주얼과 사운드 분위기를 초기 단계에서 느낄 수 있도록 맵을 구성하고, 핵심 전투 및 이동 메커니즘을 미리 체험할 수 있는 공간으로 만든다.

1인칭 플레이어의 기본 조작 및 환경 상호작용 테스트: 플레이어가 이동, 점프, 웅크리기, 슬라이드 등 기본적인 액션을 원활하게 수행하고, 점프 맵에서 난간을 잡거나 움직이는 플랫폼을 이용하는 등 환경과 상호작용하는 재미를 검증해. 또한, 간단한 스위치 조작 등을 통해 퍼즐 기믹의 가능성도 확인해 볼 수 있도록 한다.

AI 에너미의 기본적인 행동 로직 및 플레이어 반응 테스트: 적들이 플레이어를 인식하고 사격하며, 플레이어의 시선에 반응해 엄폐하거나 회피하는 기본적인 AI 로직을 구현하고 테스트해. 이를 통해 적들이 단순히 서서 맞기만 하는 것이 아니라, 플레이어에게 최소한의 위협을 가하고 전략적인 판단을 유도하는지 확인한다.



